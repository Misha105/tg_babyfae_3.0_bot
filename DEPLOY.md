# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é BabyFae Bot –Ω–∞ VPS

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Docker Compose**. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –ª–æ–∫–∞–ª—å–Ω–æ, –∏–∑–æ–ª–∏—Ä—É—è –µ–≥–æ –æ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞.

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (VPS)

–î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Backend + Frontend + Database) —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (–¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –∏ —Ç–µ—Å—Ç–æ–≤)
*   **CPU**: 1 —è–¥—Ä–æ
*   **RAM**: 1 –ì–ë (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Swap —Ñ–∞–π–ª 2-4 –ì–ë, –∏–Ω–∞—á–µ —Å–±–æ—Ä–∫–∞ –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –ø–æ –ø–∞–º—è—Ç–∏)
*   **Disk**: 15 –ì–ë SSD
*   **OS**: Ubuntu 22.04/24.04 LTS –∏–ª–∏ Debian 12/13

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ (Production, –¥–æ 10–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
*   **CPU**: 2 —è–¥—Ä–∞
*   **RAM**: 2 –ì–ë
*   **Disk**: 25 –ì–ë NVMe / SSD
*   **OS**: Ubuntu 22.04/24.04 LTS –∏–ª–∏ Debian 12/13

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
*   **Frontend**: React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏ —Ä–∞–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Nginx (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞).
*   **Backend**: Node.js/Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.
*   **Database**: SQLite, —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ volume –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
*   **Proxy**: Nginx –≤–Ω—É—Ç—Ä–∏ frontend-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã `/api` –∫ backend-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É.

---

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS

–ó–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä –ø–æ SSH.

1.  **–û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã:**
    ```bash
    sudo apt update && sudo apt upgrade -y
    sudo apt install curl git sqlite3 -y
    ```

2.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Swap (–§–∞–π–ª –ø–æ–¥–∫–∞—á–∫–∏) ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:**
    –°–±–æ—Ä–∫–∞ Frontend-—á–∞—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏. –ï—Å–ª–∏ —É –≤–∞—Å –º–µ–Ω—å—à–µ 4 –ì–ë RAM, —Å–æ–∑–¥–∞–π—Ç–µ Swap **–¥–æ** –Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –∏–Ω–∞—á–µ —Å–±–æ—Ä–∫–∞ —É–ø–∞–¥–µ—Ç —Å –æ—à–∏–±–∫–æ–π.
    ```bash
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π swap
    sudo swapon --show

    # –ï—Å–ª–∏ –ø—É—Å—Ç–æ, —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –ø–æ–¥–∫–∞—á–∫–∏ 4–ì–ë
    sudo fallocate -l 4G /swapfile
    sudo chmod 600 /swapfile
    sudo mkswap /swapfile
    sudo swapon /swapfile

    # –î–µ–ª–∞–µ–º –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º
    echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
    ```

3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ Docker Compose:**
        *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –¥–ª—è Debian: –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ sudo –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ—ë: `apt install sudo` –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É sudo.*

        –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Docker. –°–∫—Ä–∏–ø—Ç –Ω–∏–∂–µ —Å–∞–º —Ä–∞–∑–ª–∏—á–∏—Ç **Ubuntu** –∏ **Debian** –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ `404 Release` –Ω–∞ Debian 12/13).

        ```bash
        # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏, –µ—Å–ª–∏ –µ—Å—Ç—å
        sudo apt-get remove docker docker-engine docker.io containerd runc

        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        sudo apt-get update
        sudo apt-get install -y ca-certificates curl gnupg

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞ (ubuntu –∏–ª–∏ debian)
        . /etc/os-release
        DIST_ID=$ID       # ubuntu –∏–ª–∏ debian
        DIST_CODENAME=$VERSION_CODENAME  # jammy, noble, trixie –∏ —Ç.–¥.

        # –î–æ–±–∞–≤–ª—è–µ–º GPG –∫–ª—é—á Docker
        sudo install -m 0755 -d /etc/apt/keyrings
        curl -fsSL https://download.docker.com/linux/${DIST_ID}/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
        sudo chmod a+r /etc/apt/keyrings/docker.gpg

        # –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Docker –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞
        echo \
            "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/${DIST_ID} \
            ${DIST_CODENAME} stable" | \
            sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker Engine –∏ docker compose (–ø–ª–∞–≥–∏–Ω v2)
        sudo apt-get update
        sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

        # (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∑–∞–ø—É—Å–∫ Docker –±–µ–∑ sudo.
        # –í–ê–ñ–ù–û: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –ø—Ä–∞–≤–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Docker —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ root.
        # –í–∫–ª—é—á–∞–π—Ç–µ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–±—ã—á–Ω–æ –≤–∞—à–µ–≥–æ SSH-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
        sudo usermod -aG docker "$USER"
        echo "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ SSH-—Å–µ—Å—Å–∏—é, —á—Ç–æ–±—ã –≥—Ä—É–ø–ø–∞ docker –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å."
        ```

    **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker:**
    ```bash
    docker --version
    docker compose version
    sudo systemctl enable docker
    sudo systemctl start docker
    sudo systemctl status docker
    ```

---

## –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** (–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ SFTP):

    **–í–∞—Ä–∏–∞–Ω—Ç –ê: –ü—É–±–ª–∏—á–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
    ```bash
    git clone https://github.com/YOUR_USERNAME/tg_babyfae_3.0_bot.git app
    cd app
    ```

    **–í–∞—Ä–∏–∞–Ω—Ç –ë: –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (Deploy Key)**
    –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–æ–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "Deploy Key".
    1.  –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ SSH-–∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
        ```bash
        ssh-keygen -t ed25519 -C "vps-deploy"
        # –ù–∞–∂–∏–º–∞–π—Ç–µ Enter –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã (–ø—É—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –±–µ–∑ –ø–∞—Ä–æ–ª—è)
        ```
    2.  –í—ã–≤–µ–¥–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:
        ```bash
        cat ~/.ssh/id_ed25519.pub
        ```
    3.  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ GitHub: **Settings** -> **Deploy keys** -> **Add deploy key**.
    4.  –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ SSH:
        ```bash
        git clone git@github.com:YOUR_USERNAME/tg_babyfae_3.0_bot.git app
        cd app
        ```

2.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
    ```bash
    cp .env.example .env
    nano .env
    ```
    
    –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª `.env` (–µ—Å–ª–∏ –∫–∞–∫–∏—Ö-—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–µ—Ç –≤ –ø—Ä–∏–º–µ—Ä–µ, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö):
    *   `TELEGRAM_BOT_TOKEN`: –í–∞—à —Ç–æ–∫–µ–Ω –æ—Ç BotFather.
    *   `WEBAPP_URL`: `https://–≤–∞—à-–¥–æ–º–µ–Ω.com` (–≤–∞–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å https). –≠—Ç–æ URL, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤–∞—à–µ WebApp.
    *   `NODE_ENV`: `production`
    *   `PORT`: `3000`
    *   `VITE_API_URL`: –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º! (Nginx –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–∞–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç –∑–∞–ø—Ä–æ—Å—ã).
    *   `ENABLE_BOT_POLLING`: `true` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é). –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `false`, –µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ —Ç–æ–ª—å–∫–æ API-—Å–µ—Ä–≤–µ—Ä.
    *   `TZ`: `Europe/Moscow` (–∏–ª–∏ –≤–∞—à —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å). –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ –ª–æ–≥–∞—Ö.

    **–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤:**
    ```bash
    chmod 600 .env
    ```
    –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ `.env` –≤ git (—Ñ–∞–π–ª —É–∂–µ –≤ `.gitignore`). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –µ—Å–ª–∏ —Ö—Ä–∞–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.

### –ü—Ä–æ—Ñ–∏–ª–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–π (Dev/Stage/Prod)

| –ü—Ä–æ—Ñ–∏–ª—å | –¶–µ–ª—å | –û—Ç–ª–∏—á–∏—è |
| --- | --- | --- |
| Development | –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `npm run dev` –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö `bot/` –∏ `frontend/`, –≤–∫–ª—é—á–µ–Ω Vite proxy –Ω–∞ `http://localhost:3000`, `.env` –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å `NODE_ENV=development`. |
| Staging | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ VPS | –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–π—Ç–µ –ø–æ —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–æ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `staging.example.com`) –∏ Telegram-–±–æ—Ç–∞-–ø–µ—Å–æ—á–Ω–∏—Ü—É. –í –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–∫–ª—é—á–∞–π—Ç–µ `ENABLE_BOT_POLLING=false`, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç production. |
| Production | –ë–æ–µ–≤–∞—è —Å—Ä–µ–¥–∞ | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS-–¥–æ–º–µ–Ω –≤ `WEBAPP_URL`, –≤–∫–ª—é—á–∞–π—Ç–µ Swap/Firewall, —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –±—ç–∫–∞–ø–∞–º–∏. |

–°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ `.env.production`, `.env.staging` —Ñ–∞–π–ª—ã (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å) –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–π—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ `env_file` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

3.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `docker compose` (V2), –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤ 2024-2025 –≥–æ–¥–∞—Ö.
    ```bash
    sudo docker compose up -d --build
    ```
    *–ö–æ–º–∞–Ω–¥–∞ —Å–∫–∞—á–∞–µ—Ç –æ–±—Ä–∞–∑—ã, —Å–æ–±–µ—Ä–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –µ–≥–æ –≤ —Ñ–æ–Ω–µ.*
    
    **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
    –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã:
    ```bash
    sudo docker compose ps
    ```
    –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –¥–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`babyfae-bot` –∏ `babyfae-frontend`) —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `Up`.
    *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü–æ—Ä—Ç 8080 –æ—Ç–∫—Ä—ã—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ localhost (127.0.0.1) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.*

---

## –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ –∏ SSL (HTTPS)

Telegram WebApp **—Ç—Ä–µ–±—É–µ—Ç** –Ω–∞–ª–∏—á–∏–µ HTTPS. –ú—ã –Ω–∞—Å—Ç—Ä–æ–∏–º Nginx –Ω–∞ —Å–∞–º–æ–º —Å–µ—Ä–≤–µ—Ä–µ (—Ö–æ—Å—Ç–µ) –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ —Å SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º.
**–í–∞–∂–Ω–æ:** –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ—Ä—Ç `8080` –¥–ª—è Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç `80` –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Nginx.

### –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –¥–æ–º–µ–Ω–∞ (–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)
–î–ª—è —Ä–∞–±–æ—Ç—ã WebApp **–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** –¥–æ–º–µ–Ω (IP-–∞–¥—Ä–µ—Å –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞). –ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∫—É–ø–∞—Ç—å –¥–æ–º–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: sslip.io –∏–ª–∏ nip.io (–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ, –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
–≠—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç –≤–∞—à IP –≤ –¥–æ–º–µ–Ω.
1.  –£–∑–Ω–∞–π—Ç–µ IP –≤–∞—à–µ–≥–æ VPS (–Ω–∞–ø—Ä–∏–º–µ—Ä, `45.12.34.56`).
2.  –í–∞—à –¥–æ–º–µ–Ω –±—É–¥–µ—Ç: `45.12.34.56.sslip.io` –∏–ª–∏ `45.12.34.56.nip.io`.
3.  –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –≤–µ–∑–¥–µ –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–º–µ—Å—Ç–æ `your-domain.com`.

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: DuckDNS –∏–ª–∏ FreeDNS (–ö—Ä–∞—Å–∏–≤–æ–µ –∏–º—è)
1.  **DuckDNS**: –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [duckdns.org](https://www.duckdns.org). –°–æ–∑–¥–∞–π—Ç–µ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `babyfae.duckdns.org`) –∏ —É–∫–∞–∂–∏—Ç–µ IP –≤–∞—à–µ–≥–æ VPS.
2.  **FreeDNS (Afraid.org)**: –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [freedns.afraid.org](https://freedns.afraid.org/). –¢–∞–º –æ–≥—Ä–æ–º–Ω—ã–π –≤—ã–±–æ—Ä –¥–æ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `us.to`, `mooo.com`). –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –≤—ã–±–æ—Ä –∏–º–µ–Ω –±–æ–ª—å—à–µ.

#### –í–∞—Ä–∏–∞–Ω—Ç –í: –ö—É–ø–∏—Ç—å –¥–µ—à–µ–≤—ã–π –¥–æ–º–µ–Ω (–°–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)
–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –Ω–∞–¥–æ–ª–≥–æ, –ª—É—á—à–µ –∫—É–ø–∏—Ç—å –¥–æ–º–µ–Ω –≤ –∑–æ–Ω–µ `.ru`, `.site`, `.online`. –û–Ω–∏ —á–∞—Å—Ç–æ —Å—Ç–æ—è—Ç 100-200 —Ä—É–±–ª–µ–π –≤ –≥–æ–¥ (Reg.ru, Beget, Namecheap). –≠—Ç–æ –∏–∑–±–∞–≤–∏—Ç –æ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

---

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx –∏ Certbot –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—É:**
    ```bash
    sudo apt install nginx certbot python3-certbot-nginx -y
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞:**
    ```bash
    sudo nano /etc/nginx/sites-available/babyfae
    ```

    –í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ (–∑–∞–º–µ–Ω–∏—Ç–µ `your-domain.com` –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω):
    ```nginx
    server {
        listen 80;
        server_name your-domain.com;
        
        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ª–∏–º–∏—Ç –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ)
        client_max_body_size 20M;

        location / {
            proxy_pass http://127.0.0.1:8080; # –ü—Ä–æ–∫—Å–∏—Ä—É–µ–º –Ω–∞ –Ω–∞—à Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–ø–æ—Ä—Ç 8080)
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebSocket (–≤–∞–∂–Ω–æ –¥–ª—è HMR –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π Telegram)
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }
    }
    ```

3.  **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Å–∞–π—Ç:**
    ```bash
    sudo ln -s /etc/nginx/sites-available/babyfae /etc/nginx/sites-enabled/
    sudo nginx -t # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: syntax is ok, test is successful)
    sudo systemctl restart nginx
    ```

4.  **–ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):**
    ```bash
    sudo certbot --nginx -d your-domain.com
    ```
    –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ. Certbot —Å–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç HTTPS –∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞.

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (Health-check)

1.  **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ c —Å–µ—Ä–≤–µ—Ä–∞:**
    ```bash
    curl -I http://127.0.0.1:8080
    ```
    –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `HTTP/1.1 200 OK`.

2.  **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ HTTPS c –≤–Ω–µ—à–Ω–µ–≥–æ –∞–¥—Ä–µ—Å–∞ (–º–æ–∂–Ω–æ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã):**
    ```bash
    curl -I https://your-domain.com
    ```

3.  **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ backend health endpoint:**
    ```bash
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º wget, —Ç–∞–∫ –∫–∞–∫ curl –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –æ–±—Ä–∞–∑–µ
    sudo docker compose exec bot wget --no-verbose --tries=1 --spider http://127.0.0.1:3000/health
    ```
    –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–≤–µ–ª–∞ (–∏–ª–∏ –≤–µ—Ä–Ω—É–ª–∞ 0) ‚Äî –≤—Å–µ –æ–∫. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

4.  **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏:**
    ```bash
    sudo docker compose logs --tail=50 bot frontend
    ```

–ï—Å–ª–∏ –∫–∞–∫–æ–π-–ª–∏–±–æ —à–∞–≥ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Ä–∞–∑–¥–µ–ª—É "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫".

---

## –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Telegram

1.  –û—Ç–∫—Ä–æ–π—Ç–µ **BotFather** –≤ Telegram.
2.  –í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞.
3.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Bot Settings` -> `Menu Button` -> `Configure Menu Button`.
4.  –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à —Å–∞–π—Ç: `https://your-domain.com` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å https).
5.  –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∞ "–ú–µ–Ω—é" –≤ –±–æ—Ç–µ –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –≤–∞—à–µ WebApp.

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

*   **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:**
    ```bash
    sudo docker compose logs -f
    ```

*   **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
    ```bash
    sudo docker compose restart
    ```

*   **–ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
    ```bash
    sudo docker compose down
    ```

*   **–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å:**
    ```bash
    git pull
    sudo docker compose up -d --build
    ```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ VPS

–ß—Ç–æ–±—ã –≤–∞—à —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

### 1. –ë–∞–∑–æ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Firewall & SSH)
–ù–µ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ —Å–µ—Ä–≤–µ—Ä –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–ª—è –≤—Å–µ—Ö –≤–µ—Ç—Ä–æ–≤.

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UFW (Firewall)
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw allow 443/tcp  # HTTPS
sudo ufw enable

# 2. –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ (Fail2Ban)
sudo apt install fail2ban -y
sudo systemctl start fail2ban
sudo systemctl enable fail2ban
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ SSH:** –û—Ç–∫–ª—é—á–∏—Ç–µ –≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é.
1.  –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –¥–æ–±–∞–≤–∏–ª–∏ —Å–≤–æ–π SSH-–∫–ª—é—á (`ssh-copy-id user@host`).
2.  –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥: `sudo nano /etc/ssh/sshd_config`
3.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: `PasswordAuthentication no`
4.  –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `sudo systemctl restart ssh`

### 2. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ Docker
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Docker —Ö—Ä–∞–Ω–∏—Ç –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ, —á—Ç–æ –º–æ–∂–µ—Ç –∑–∞–±–∏—Ç—å –¥–∏—Å–∫. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é.

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/docker/daemon.json`:
```json
{
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  }
}
```
–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Docker: `sudo systemctl restart docker`.

---

### 3. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (Backups)
–ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

–¢–∞–∫ –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ —á–µ—Ä–µ–∑ volume (`./data:/app/data`), –º—ã –º–æ–∂–µ–º –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –ø—Ä—è–º–æ —Å —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—É—é —É—Ç–∏–ª–∏—Ç—É `sqlite3`.

–ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ç–∫–∞–ø–∞ (–¥–æ–±–∞–≤—å—Ç–µ –≤ cron):
```bash
#!/bin/bash
# –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ –ª–µ–∂–∏—Ç docker-compose.yml)
PROJECT_DIR="/root/app"
DATA_DIR="$PROJECT_DIR/data"
BACKUP_DIR="/root/backups"
DATE=$(date +%Y-%m-%d_%H-%M-%S)

mkdir -p $BACKUP_DIR

# –ò—Å–ø–æ–ª—å–∑—É–µ–º sqlite3 –Ω–∞ —Ö–æ—Å—Ç–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ (–¥–∞–∂–µ –µ—Å–ª–∏ –±–∞–∑–∞ –∞–∫—Ç–∏–≤–Ω–∞)
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ sqlite3 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: sudo apt install sqlite3
if [ -f "$DATA_DIR/babyfae.db" ]; then
    sqlite3 "$DATA_DIR/babyfae.db" ".backup '$BACKUP_DIR/babyfae_$DATE.db'"
    echo "Backup created: $BACKUP_DIR/babyfae_$DATE.db"
else
    echo "Database file not found at $DATA_DIR/babyfae.db"
fi

# –£–¥–∞–ª—è–µ–º –±—ç–∫–∞–ø—ã —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
find $BACKUP_DIR -type f -name "*.db" -mtime +7 -delete
```

### 5. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ (Restore)
–ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ä–µ–¥–∏–ª–∞—Å—å –∏–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é:

1.  **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞:**
    –í–∞–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –ø–µ—Ä–µ–¥ –∑–∞–º–µ–Ω–æ–π —Ñ–∞–π–ª–∞.
    ```bash
    sudo docker compose stop bot
    ```

2.  **–ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—ã–π –±—ç–∫–∞–ø:**
    ```bash
    ls -lh /root/backups/
    # –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä: babyfae_2025-11-24_12-00-00.db
    ```

3.  **–ó–∞–º–µ–Ω–∏—Ç–µ —Ç–µ–∫—É—â—É—é –±–∞–∑—É:**
    ```bash
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é (—Å–ª–æ–º–∞–Ω–Ω—É—é) –±–∞–∑—É –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
    mv /root/app/data/babyfae.db /root/app/data/babyfae.db.broken

    # –ö–æ–ø–∏—Ä—É–µ–º –±—ç–∫–∞–ø –Ω–∞ –º–µ—Å—Ç–æ –±–æ–µ–≤–æ–π –±–∞–∑—ã
    cp /root/backups/babyfae_2025-11-24_12-00-00.db /root/app/data/babyfae.db
    ```

4.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
    ```bash
    sudo docker compose start bot
    ```

### 6. –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä (Migration)
–ü–µ—Ä–µ–Ω–æ—Å –±–æ—Ç–∞ –Ω–∞ –¥—Ä—É–≥–æ–π VPS —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∏—Å—Ç–æ—Ä–∏—è).

#### –≠—Ç–∞–ø 1: –î–µ–π—Å—Ç–≤–∏—è –Ω–∞ –°–¢–ê–†–û–ú —Å–µ—Ä–≤–µ—Ä–µ
1.  **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞:**
    –í–∞–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
    ```bash
    cd /root/app  # –ò–ª–∏ –≤–∞—à–∞ –ø–∞–ø–∫–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º
    sudo docker compose down
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ö–∏–≤ —Å –≤–∞–∂–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:**
    –ú—ã –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Ç–æ–ª—å–∫–æ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (`data/`) –∏ —Å–µ–∫—Ä–µ—Ç—ã (`.env`). –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ—â–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ —Å–∫–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ –∏–∑ Git.
    ```bash
    # –°–æ–∑–¥–∞–µ–º –∞—Ä—Ö–∏–≤ migration_backup.tar.gz, –≤–∫–ª—é—á–∞—é—â–∏–π –ø–∞–ø–∫—É data –∏ —Ñ–∞–π–ª .env
    tar -czvf migration_backup.tar.gz data .env
    ```

3.  **–°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤:**
    –ó–∞–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª `migration_backup.tar.gz` —Å–æ —Å—Ç–∞—Ä–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —Å–≤–æ–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä.
    *   **–ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å (—Å –≤–∞—à–µ–≥–æ –ü–ö):** `scp root@OLD_IP:/root/app/migration_backup.tar.gz .`
    *   **–ß–µ—Ä–µ–∑ SFTP:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ FileZilla –∏–ª–∏ WinSCP.

#### –≠—Ç–∞–ø 2: –î–µ–π—Å—Ç–≤–∏—è –Ω–∞ –ù–û–í–û–ú —Å–µ—Ä–≤–µ—Ä–µ
1.  **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
    –í—ã–ø–æ–ª–Ω–∏—Ç–µ **–®–∞–≥ 1** –¥–∞–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker, **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Swap**).

2.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∫–æ–¥:**
    –í—ã–ø–æ–ª–Ω–∏—Ç–µ **–®–∞–≥ 2, –ø—É–Ω–∫—Ç 1** (–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è).
    ```bash
    git clone https://github.com/YOUR_USERNAME/tg_babyfae_3.0_bot.git app
    cd app
    ```

3.  **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—Ä—Ö–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏:**
    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞.
    *   **–ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å (—Å –≤–∞—à–µ–≥–æ –ü–ö):** `scp migration_backup.tar.gz root@NEW_IP:/root/app/`

4.  **–†–∞—Å–ø–∞–∫—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ:**
    ```bash
    # –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç .env –∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    tar -xzvf migration_backup.tar.gz
    
    # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
    ls -la
    ```

5.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
    ```bash
    sudo docker compose up -d --build
    ```

6.  **–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –¥–æ–º–µ–Ω:**
    1.  –ó–∞–π–¥–∏—Ç–µ –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–æ–º–µ–Ω–∞ –∏ –∏–∑–º–µ–Ω–∏—Ç–µ **A-–∑–∞–ø–∏—Å—å** –Ω–∞ IP-–∞–¥—Ä–µ—Å –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
    2.  –í—ã–ø–æ–ª–Ω–∏—Ç–µ **–®–∞–≥ 3** –¥–∞–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞) –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ.
    3.  *–°—Ç–∞—Ä—ã–π —Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–æ –≤—ã–∫–ª—é—á–∞—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DNS –æ–±–Ω–æ–≤–∏–ª—Å—è –∏ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.*

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ (Dozzle)

–í –ø—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω **Dozzle** ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------------|----------|
| RAM | ~10-15 MB |
| CPU | <1% |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | Bcrypt –ø–∞—Ä–æ–ª–∏, HTTPS |

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–æ–ª—è

```bash
# –ù–∞ VPS –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö–µ—à –ø–∞—Ä–æ–ª—è
docker run -it --rm amir20/dozzle generate admin --password "–í–∞—à–ù–∞–¥—ë–∂–Ω—ã–π–ü–∞—Ä–æ–ª—å123!"
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥ –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `monitoring/dozzle-data/users.yml`.

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫

Dozzle –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–º–µ—Å—Ç–µ —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:
```bash
sudo docker compose up -d --build
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥ `/etc/nginx/sites-available/babyfae`, –¥–æ–±–∞–≤–∏–≤ —Å–µ–∫—Ü–∏—é –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

```nginx
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSL (Certbot)
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
    
    # Security headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    
    client_max_body_size 20M;

    # Main App
    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # Monitoring Panel (Dozzle)
    location /monitor/ {
        proxy_pass http://127.0.0.1:9999/monitor/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_read_timeout 86400;
        proxy_buffering off;
    }
}
```

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
```bash
sudo nginx -t && sudo systemctl reload nginx
```

### –î–æ—Å—Ç—É–ø –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É

```
https://your-domain.com/monitor/
```

–õ–æ–≥–∏–Ω: `admin`, –ø–∞—Ä–æ–ª—å: –≤–∞—à —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å.

> üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [monitoring/README.md](monitoring/README.md)

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ (Troubleshooting)

### 1. –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
*   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `sudo docker compose logs -f bot`
*   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤ `.env` –≤–µ—Ä–Ω—ã–π.
*   –í —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Long Polling** (`ENABLE_BOT_POLLING=true`), –ø–æ—ç—Ç–æ–º—É –æ–Ω –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞.

### 2. WebApp –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –±–µ–ª—ã–º —ç–∫—Ä–∞–Ω–æ–º
*   –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∏–ª–∏ Telegram Desktop).
*   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É Network. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/...` –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–æ–π 404 –∏–ª–∏ 502, –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–≤—è–∑–∏ Frontend -> Backend.
*   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Nginx –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `sudo docker compose logs -f frontend`.
*   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ WebApp –ø–æ HTTPS —Å—Å—ã–ª–∫–µ.

### 3. –û—à–∏–±–∫–∞ "Database is locked"
*   SQLite –≤ —Ä–µ–∂–∏–º–µ WAL —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é, –Ω–æ –µ—Å–ª–∏ —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–æ—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –æ–¥–∏–Ω —Ñ–∞–π–ª –ë–î, –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã.
*   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `bot`.

### 4. –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ (OOM / Out of Memory)
*   –ï—Å–ª–∏ `npm run build` –ø–∞–¥–∞–µ—Ç —Å –∫–æ–¥–æ–º 137, –∑–Ω–∞—á–∏—Ç –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
*   **–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Swap (—Å–º. —Ä–∞–∑–¥–µ–ª –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤—ã—à–µ).

---

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (Scalability)

–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ –æ–¥–Ω–æ–º VPS (Vertical Scaling). –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –≤ —Ä–µ–∂–∏–º–µ WAL, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ç—ã—Å—è—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É) –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö.

### –£—Ä–æ–≤–µ–Ω—å 1: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ (–¥–æ 10-50 —Ç—ã—Å. –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ –º–æ—â–Ω–æ–≥–æ VPS.
1.  –£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞ (CPU/RAM).
2.  SQLite –≤ —Ä–µ–∂–∏–º–µ WAL (–≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –¥–ª—è —á—Ç–µ–Ω–∏—è.

### –£—Ä–æ–≤–µ–Ω—å 2: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (High Load)
–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

1.  **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ú–∏–≥—Ä–∞—Ü–∏—è —Å SQLite –Ω–∞ **PostgreSQL**.
    *   –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é `dbAsync` (`src/database/db-helper.ts`), –ø–æ—ç—Ç–æ–º—É –º–∏–≥—Ä–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pg` –¥—Ä–∞–π–≤–µ—Ä–∞, –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –≤—Å–µ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.
2.  **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤**:
    *   –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ `bot` (API) –∑–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–º –Ω–∞–≥—Ä—É–∑–∫–∏ (Nginx/HAProxy).
    *   –í—ã–¥–µ–ª–∏—Ç–µ **–æ–¥–∏–Ω** –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Telegram-—Å–æ–±—ã—Ç–∏–π –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (Scheduler), —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `ENABLE_BOT_POLLING=true` —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–≥–æ, –∏ `false` –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö API-–≤–æ—Ä–∫–µ—Ä–æ–≤.
3.  **–û—á–µ—Ä–µ–¥–∏**:
    *   –î–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–Ω–µ–¥—Ä–∏—Ç—å Redis –∏ BullMQ –≤–º–µ—Å—Ç–æ in-memory –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.

### –£—Ä–æ–≤–µ–Ω—å 3: Kubernetes (K8s)
Kubernetes ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏, –Ω–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –£—Ä–æ–≤–µ–Ω—å 2 (PostgreSQL)**.

**–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –≤ K8s?**
–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite (—Ñ–∞–π–ª–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö). –í Kubernetes –ø–æ–¥—ã (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã) —ç—Ñ–µ–º–µ—Ä–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É–∑–ª–∞—Ö.
*   –ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å 2 —Ä–µ–ø–ª–∏–∫–∏ –±–æ—Ç–∞, —É –∫–∞–∂–¥–æ–π –±—É–¥–µ—Ç **—Å–≤–æ–π** —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–±—â–µ–≥–æ —Ç–æ–º–∞), —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è K8s:**
1.  **Database**: Managed PostgreSQL (–Ω–∞–ø—Ä–∏–º–µ—Ä, AWS RDS, Google Cloud SQL) –∏–ª–∏ StatefulSet —Å PostgreSQL –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞.
2.  **Backend (Bot)**: Deployment —Å `replicas: N`.
    *   –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é **stateless** (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ñ–∞–π–ª—ã).
    *   –í—Å–µ —Å–µ—Å—Å–∏–∏ –∏ –∫—ç—à–∏ –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ Redis.
3.  **Frontend**: Deployment —Å Nginx, —Ä–∞–∑–¥–∞—é—â–∏–º —Å—Ç–∞—Ç–∏–∫—É.
4.  **Ingress**: Nginx Ingress Controller –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è SSL –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Kubernetes, –ø–æ–∫–∞ –Ω–µ —É–ø—Ä–µ—Ç–µ—Å—å –≤ –ª–∏–º–∏—Ç—ã –æ–¥–Ω–æ–≥–æ –º–æ—â–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Å Docker Compose. –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ K8s –¥–ª—è –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –Ω–µ –æ–∫—É–ø–∞–µ—Ç—Å—è.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
–í —Ñ–∞–π–ª–µ `.env` –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ–∂–∏–º–æ–º —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞:
```env
# true (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –∑–∞–ø—É—Å–∫–∞–µ—Ç polling –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫.
# false - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ API —Å–µ—Ä–≤–µ—Ä (–¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è API).
ENABLE_BOT_POLLING=true
```
